<!DOCTYPE HTML>

<html>
    <head>
        
            
                <title>Get Sankey!
Sankey diagrams for infosec</title>
            
        

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="generator" content="Hugo 0.19" />
        


        
            <meta name="author" content="Tony Towry">
        
        
            
                <meta name="description" content="Musings on life and work.">
            
        

        

  <meta name="twitter:card" content="summary"/>



<meta name="twitter:text:title" content="Get Sankey!
Sankey diagrams for infosec"/>
<meta name="twitter:title" content="Get Sankey!
Sankey diagrams for infosec"/>
<meta name="twitter:description" content="Yesterday, a tweet caught my eye.
It was something that I know I’d seen before, but it somehow had escaped my memory as to what it was called or how it was constructed. Well, it bugged me enough that I had to track it down.
It was the Sankey Chart.
tweet from @wendynather
 You can view the original tweet here.
As I am currently neck deep in writing an annual risk report it’d be easy for me to agree with the thought."/>
<meta name="twitter:site" content="@anthonytowry"/>

        <meta property="og:title" content="Get Sankey!
Sankey diagrams for infosec" />
<meta property="og:description" content="Yesterday, a tweet caught my eye.
It was something that I know I’d seen before, but it somehow had escaped my memory as to what it was called or how it was constructed. Well, it bugged me enough that I had to track it down.
It was the Sankey Chart.
tweet from @wendynather
 You can view the original tweet here.
As I am currently neck deep in writing an annual risk report it’d be easy for me to agree with the thought." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/sankey/" />



<meta property="article:published_time" content="2017-05-19T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2017-05-19T00:00:00&#43;00:00"/>











        
<meta itemprop="name" content="Get Sankey!
Sankey diagrams for infosec">
<meta itemprop="description" content="Yesterday, a tweet caught my eye.
It was something that I know I’d seen before, but it somehow had escaped my memory as to what it was called or how it was constructed. Well, it bugged me enough that I had to track it down.
It was the Sankey Chart.
tweet from @wendynather
 You can view the original tweet here.
As I am currently neck deep in writing an annual risk report it’d be easy for me to agree with the thought.">


<meta itemprop="dateModified" content="2017-05-19T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="578">



<meta itemprop="keywords" content="Dataviz,Hugo,R,coffee,management,Dataviz,R Markdown,infosec,plot,regression," />

        

        

        
        
            
        

        
        
            <link rel="stylesheet" href="/css/google-font.css" />
            <link rel="stylesheet" href="/css/font-awesome.min.css" />
            <link rel="stylesheet" href="/css/main.css" />
            <link rel="stylesheet" href="/css/add-on.css" />
            <link rel="stylesheet" href="/css/monokai-sublime.css">
        

        

        
        
        
            
        
    </head>
    <body>

        
        <div id="wrapper">

    
    
<header id="header">
    
        <h2><a href="/">One Scenario</i></a></h2>
    

    <nav class="links">
        <ul>
            
                <li>
                    <a href="/blog">
                        
                            <i class="fa fa-bomb">&nbsp;</i>Blog
                    </a>
                </li>
            
                <li>
                    <a href="/categories">
                        Categories
                    </a>
                </li>
            
                <li>
                    <a href="/training">
                        Training
                    </a>
                </li>
            
                <li>
                    <a href="/about">
                        About
                    </a>
                </li>
            
        </ul>
    </nav>
    <nav class="main">
        <ul>
            
            <li id="share-nav" class="share-menu" style="display:none;">
                <a class="fa-share-alt" href="#share-menu">Share</a>
            </li>
            
            <li class="search">
                <a class="fa-search" href="#search">Search</a>
                <form id="search" method="get" action="//google.com/search">
                    <input type="text" name="q" placeholder="Search" />
                    <input type="hidden" name="q" value="site:/">
                </form>
            </li>
            <li class="menu">
                <a class="fa-bars" href="#menu">Menu</a>
            </li>
        </ul>
    </nav>
</header>


<section id="menu">

    
        <section>
            <form class="search" method="get" action="//google.com/search">
                <input type="text" name="q" placeholder="Search" />
                <input type="hidden" name="q" value="site:/">
            </form>
        </section>

    
        <section>
            <ul class="links">
                
                    <li>
                        <a href="/blog">
                            <h3>
                                
                                    <i class="fa fa-bomb">&nbsp;</i>
                                
                                Blog
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/categories">
                            <h3>
                                
                                Categories
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/training">
                            <h3>
                                
                                Training
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/about">
                            <h3>
                                
                                About
                            </h3>
                        </a>
                    </li>
                
            </ul>
        </section>

    
        <section>
            <ul class="links">
                <header>
                    <h3>Recent Posts</h3>
                </header>
                
                    
                

                
                    <li>
                        <a href="/blog/coffee%20guide/"><p>Tony&#39;s Coffee Guide</p></a>
                    </li>
                
                    <li>
                        <a href="/blog/Fail-to-scale-part1/"><p>If You’re Going to Fail To Scale, Don’t - Part I</p></a>
                    </li>
                
            </ul>
        </section>

    
        
</section>

    <section id="share-menu">
    <section id="social-share-nav">
        <ul class="links">
            <header>
                <h3>Share this post <i class="fa fa-smile-o"></i></h3>
            </header>
            


<li><a href="//twitter.com/share?url=%2fpost%2fsankey%2f&text=Get%20Sankey%21%0aSankey%20diagrams%20for%20infosec&via=anthonytowry" target="_blank" class="share-btn twitter">
    <i class="fa fa-twitter"></i>
    <p>Twitter</p>
</a></li>


<li><a href="//plus.google.com/share?url=%2fpost%2fsankey%2f" target="_blank" class="share-btn google-plus">
    <i class="fa fa-google-plus"></i>
    <p>Google+</p>
</a></li>


<li><a href="//www.facebook.com/sharer/sharer.php?u=%2fpost%2fsankey%2f" target="_blank" class="share-btn facebook">
    <i class="fa fa-facebook"></i>
    <p>Facebook</p>
</a></li>


<li><a href="//reddit.com/submit?url=%2fpost%2fsankey%2f&title=Get%20Sankey%21%0aSankey%20diagrams%20for%20infosec" target="_blank" class="share-btn reddit">
    <i class="fa fa-reddit-alien"></i>
    <p>Reddit</p>
</a></li>


<li><a href="//www.linkedin.com/shareArticle?url=%2fpost%2fsankey%2f&title=Get%20Sankey%21%0aSankey%20diagrams%20for%20infosec" target="_blank" class="share-btn linkedin">
    <i class="fa fa-linkedin"></i>
    <p>LinkedIn</p>
</a></li>


<li><a href="//www.stumbleupon.com/submit?url=%2fpost%2fsankey%2f&title=Get%20Sankey%21%0aSankey%20diagrams%20for%20infosec" target="_blank" class="share-btn stumbleupon">
    <i class="fa fa-stumbleupon"></i>
    <p>StumbleUpon</p>
</a></li>


<li><a href="mailto:?subject=Check out this post by Tony%20Towry&body=%2fpost%2fsankey%2f" target="_blank" class="share-btn email">
    <i class="fa fa-envelope"></i>
    <p>Email</p>
</a></li>

        </ul>
    </section>
</section>

    
    <div id="main">
        
        
        <article class="post">
    <header>
    <div class="title">
        
            <h1><a href="/post/sankey/">Get Sankey!
Sankey diagrams for infosec</a></h1>
            
        
        
    </div>
    <div class="meta">
        
            
        

        <time class="published"
            datetime='2017-05-19'>
            May 19, 2017</time>
        <span class="author">Tony Towry</span>
        
            <p>3 minute read</p>
        
        
    </div>
</header>


    <section id="social-share">
        <ul class="icons">
            


<li><a href="//twitter.com/share?url=%2fpost%2fsankey%2f&text=Get%20Sankey%21%0aSankey%20diagrams%20for%20infosec&via=anthonytowry" target="_blank" class="share-btn twitter">
    <i class="fa fa-twitter"></i>
    <p>Twitter</p>
</a></li>


<li><a href="//plus.google.com/share?url=%2fpost%2fsankey%2f" target="_blank" class="share-btn google-plus">
    <i class="fa fa-google-plus"></i>
    <p>Google+</p>
</a></li>


<li><a href="//www.facebook.com/sharer/sharer.php?u=%2fpost%2fsankey%2f" target="_blank" class="share-btn facebook">
    <i class="fa fa-facebook"></i>
    <p>Facebook</p>
</a></li>


<li><a href="//reddit.com/submit?url=%2fpost%2fsankey%2f&title=Get%20Sankey%21%0aSankey%20diagrams%20for%20infosec" target="_blank" class="share-btn reddit">
    <i class="fa fa-reddit-alien"></i>
    <p>Reddit</p>
</a></li>


<li><a href="//www.linkedin.com/shareArticle?url=%2fpost%2fsankey%2f&title=Get%20Sankey%21%0aSankey%20diagrams%20for%20infosec" target="_blank" class="share-btn linkedin">
    <i class="fa fa-linkedin"></i>
    <p>LinkedIn</p>
</a></li>


<li><a href="//www.stumbleupon.com/submit?url=%2fpost%2fsankey%2f&title=Get%20Sankey%21%0aSankey%20diagrams%20for%20infosec" target="_blank" class="share-btn stumbleupon">
    <i class="fa fa-stumbleupon"></i>
    <p>StumbleUpon</p>
</a></li>


<li><a href="mailto:?subject=Check out this post by Tony%20Towry&body=%2fpost%2fsankey%2f" target="_blank" class="share-btn email">
    <i class="fa fa-envelope"></i>
    <p>Email</p>
</a></li>

        </ul>
    </section>
    

    <div id="content">
        <!-- BLOGDOWN-HEAD -->
<!-- /BLOGDOWN-HEAD -->

<!-- BLOGDOWN-BODY-BEFORE -->
<!-- /BLOGDOWN-BODY-BEFORE -->
<p>Yesterday, a tweet caught my eye.</p>
<p>It was something that I know I’d seen before, but it somehow had escaped my memory as to what it was called or how it was constructed. Well, it bugged me enough that I had to track it down.</p>
<p>It was the <a href="https://developers.google.com/chart/interactive/docs/gallery/sankey#Configuration_Options">Sankey Chart</a>.</p>
<div class="figure">
<img src="/img/main/twittersankey2.png" alt="tweet from @wendynather" />
<p class="caption">tweet from <span class="citation">@wendynather</span></p>
</div>
<p>You can view the original tweet <a href="https://twitter.com/jwgoerlich/status/865262781100167169">here</a>.</p>
<p>As I am currently neck deep in writing an annual risk report it’d be easy for me to agree with the thought.</p>
<p>Visualization done well <strong>CAN’T</strong> make all the difference, but it can make a little difference. Moreover, there are some relationships, linear layers of abstraction, that are particularly well suited for display by Sankey diagram.</p>
<p>So, let’s play with them in the googleVis package for R. There are other packages that should be able to produce Sankey charts, but none appeared to be as aesthetically pleasing out of the box (or with lower effort applied at least).</p>
<p>First make sure you have googleVis installed. <code>install.packages(&quot;googleVis&quot;)</code></p>
<p>The first thing of note is that we need to have the data frame such that there is a column of start nodes and a column of end nodes. gvisSankey() will create all of the layers necessary to accommodate the links. For example, if A -&gt; B and B -&gt; C, gvisSankey() will create the flow from A-&gt;B-&gt;C.</p>
<pre class="r"><code>library(googleVis)
options(gvis.plot.tag=&#39;chart&#39;)

# Create some edges
flowing.threat.model &lt;- data.frame(From = c(&quot;Web App Vuln (XSS)&quot;, &quot;Web App Vuln (XSS)&quot;, &quot;Phishing Email&quot;, &quot;Default Creds&quot;, &quot;Control 1&quot;, &quot;Control 2&quot;,&quot;Control 3&quot;, &quot;Control 4&quot;,&quot;Default Creds&quot;,&quot;Control 5&quot;),
                                   To = c(&quot;Control 1&quot;, &quot;Control 2&quot;, &quot;Control 3&quot;, &quot;Control 4&quot;, &quot;Application security&quot;, &quot;Security monitoring&quot;,&quot;Security monitoring&quot;, &quot;Configuration management&quot;,&quot;Control 5&quot;,&quot;Security monitoring&quot;),
                                Weight = c(rep(1,10))) # This last one is just setting uniform weight across each link

# Plot your Sankey!

Sankey &lt;- gvisSankey(flowing.threat.model, from=&quot;From&quot;, to=&quot;To&quot;, weight=&quot;Weight&quot;,
                     options=list(
                       sankey=&quot;{link: {color: { fill: &#39;#cccccc&#39;, fillOpacity: 80 } },
                       node: { color: { fill: &#39;#a61d4c&#39; }, nodePadding:40,
                       label: { color: &#39;#000000&#39;, bold:true } }}&quot;, width = 800))

plot(Sankey)</code></pre>
<!-- Sankey generated in R 3.3.3 by googleVis 0.6.2 package -->
<!-- Tue May 30 21:38:38 2017 -->
<!-- jsHeader -->
<script type="text/javascript">
 
// jsData 
function gvisDataSankeyID272b7e895b2c () {
var data = new google.visualization.DataTable();
var datajson =
[
 [
"Web App Vuln (XSS)",
"Control 1",
1
],
[
"Web App Vuln (XSS)",
"Control 2",
1
],
[
"Phishing Email",
"Control 3",
1
],
[
"Default Creds",
"Control 4",
1
],
[
"Control 1",
"Application security",
1
],
[
"Control 2",
"Security monitoring",
1
],
[
"Control 3",
"Security monitoring",
1
],
[
"Control 4",
"Configuration management",
1
],
[
"Default Creds",
"Control 5",
1
],
[
"Control 5",
"Security monitoring",
1
] 
];
data.addColumn('string','From');
data.addColumn('string','To');
data.addColumn('number','Weight');
data.addRows(datajson);
return(data);
}
 
// jsDrawChart
function drawChartSankeyID272b7e895b2c() {
var data = gvisDataSankeyID272b7e895b2c();
var options = {};
options["width"] = 800;
options["height"] = 400;
options["sankey"] = {link: {color: { fill: '#cccccc', fillOpacity: 80 } },
                       node: { color: { fill: '#a61d4c' }, nodePadding:40,
                       label: { color: '#000000', bold:true } }};

    var chart = new google.visualization.Sankey(
    document.getElementById('SankeyID272b7e895b2c')
    );
    chart.draw(data,options);
    

}
  
 
// jsDisplayChart
(function() {
var pkgs = window.__gvisPackages = window.__gvisPackages || [];
var callbacks = window.__gvisCallbacks = window.__gvisCallbacks || [];
var chartid = "sankey";
  
// Manually see if chartid is in pkgs (not all browsers support Array.indexOf)
var i, newPackage = true;
for (i = 0; newPackage && i < pkgs.length; i++) {
if (pkgs[i] === chartid)
newPackage = false;
}
if (newPackage)
  pkgs.push(chartid);
  
// Add the drawChart function to the global list of callbacks
callbacks.push(drawChartSankeyID272b7e895b2c);
})();
function displayChartSankeyID272b7e895b2c() {
  var pkgs = window.__gvisPackages = window.__gvisPackages || [];
  var callbacks = window.__gvisCallbacks = window.__gvisCallbacks || [];
  window.clearTimeout(window.__gvisLoad);
  // The timeout is set to 100 because otherwise the container div we are
  // targeting might not be part of the document yet
  window.__gvisLoad = setTimeout(function() {
  var pkgCount = pkgs.length;
  google.load("visualization", "1", { packages:pkgs, callback: function() {
  if (pkgCount != pkgs.length) {
  // Race condition where another setTimeout call snuck in after us; if
  // that call added a package, we must not shift its callback
  return;
}
while (callbacks.length > 0)
callbacks.shift()();
} });
}, 100);
}
 
// jsFooter
</script>
<!-- jsChart -->
<script type="text/javascript" src="https://www.google.com/jsapi?callback=displayChartSankeyID272b7e895b2c"></script>
<!-- divChart -->
<div id="SankeyID272b7e895b2c" style="width: 800; height: 400;">

</div>
<p>That’s it! The creation of the diagram isn’t particularly hard. The genius part is coming up with the ideas you’d like to represent.</p>
<p>For more awesome network and Sankey action check out <a href="http://personal.tcu.edu/kylewalker/interactive-flow-visualization-in-r.html">Kyle Walker, Phd’s post on Interactive flow visualization in R</a></p>

    </div>

    <footer>
        <ul class="stats">
    
        

        
        
            <li>
                
                
                    

                    

                    

                    
                        Categories
                    
                
            </li>
        
    

    
    
        <li><a href='/categoriesr'>R</a></li>
    
        <li><a href='/categoriesdataviz'>Dataviz</a></li>
    
</ul>

    </footer>
</article>
<ul class="actions pagination">
    
        <li><a href="/post/2015-07-23-r-rmarkdown/"
                class="button big previous">RMarkdown</a></li>
    

    
</ul>



    
        <article class="post">
            <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'shortname';
    var disqus_identifier = '\/post\/sankey\/';
    var disqus_title = 'Get Sankey!\nSankey diagrams for infosec';
    var disqus_url = '\/post\/sankey\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </article>
    


    </div>
    
<section id="sidebar">

    
        <section id="intro">
            
            
                
                    <img src="/img/main/proflogo.png" class="intro-circle" width="80" alt="Hugo Future Imperfect" />
                
            
            
                <header>
                    <h2>One Scenario At a Time, Please</h2>
                    <p>Musings On Information Risk, Life and the Road.</p>
                </header>
            
            <ul class="icons">
                
                
                    
<li><a href="//github.com/cattleguard" target="_blank" title="GitHub" class="fa fa-github"></a></li>

















































<li><a href="//twitter.com/anthonytowry" target="_blank" title="Twitter" class="fa fa-twitter"></a></li>



<li><a href="mailto:anthonytowry@gmail.com" title="Email" class="fa fa-envelope"></a></li>


                
            </ul>
        </section>

    
        <section id="recent-posts">
            <ul class="posts">
                <header>
                    <h3>Recent Posts</h3>
                </header>
                
                    
                

                
                    
                

                
                    <li>
                        <article>
                            <header>
                                <h3><a href="/blog/coffee%20guide/">Tony&#39;s Coffee Guide</a></h3>
                                
                                    
                                
                                <time class="published" datetime=
                                    '2017-06-25'>
                                    June 25, 2017</time>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <h3><a href="/blog/Fail-to-scale-part1/">If You’re Going to Fail To Scale, Don’t - Part I</a></h3>
                                
                                    
                                
                                <time class="published" datetime=
                                    '2017-05-30'>
                                    May 30, 2017</time>
                            </header>
                        </article>
                    </li>
                

                
                    <li>
                        <ul class="actions">
                            <li><a href=
                            
                                /blog/
                            
                            class="button">View more posts</a></li>
                        </ul>
                    </li>
                
            </ul>
        </section>

    
    
    
    
        <section id="categories">
            <ul class="posts">
                <header>
                    <h3><a href="/categories/">Categories</a></h3>
                </header>

                
                    
                

                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/r/">R</a>
                                <span style="float:right;">4</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/dataviz/">Dataviz</a>
                                <span style="float:right;">1</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/hugo/">Hugo</a>
                                <span style="float:right;">1</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/coffee/">coffee</a>
                                <span style="float:right;">1</span>
                            </header>
                        </article>
                    </li>
                
                    <li>
                        <article>
                            <header>
                                <a href="/categories/management/">management</a>
                                <span style="float:right;">1</span>
                            </header>
                        </article>
                    </li>
                
            </ul>
        </section>
    

    
        
        <section class="blurb">
            <h2>About</h2>
            <p>I build risk-informed information security programs. OSCP, CISSP, CISA. Opinions are my own.</p>

            <ul class="actions">
                <li><a href="/about/" class="button">Learn More</a></li>
            </ul>
        </section>
        

    
        <section id="footer">
            <ul class="icons">
                
                
                    
<li><a href="//github.com/cattleguard" target="_blank" title="GitHub" class="fa fa-github"></a></li>

















































<li><a href="//twitter.com/anthonytowry" target="_blank" title="Twitter" class="fa fa-twitter"></a></li>



<li><a href="mailto:anthonytowry@gmail.com" title="Email" class="fa fa-envelope"></a></li>


                
            </ul>

            <p class="copyright">&copy; One Scenario. Design: <a href="http://html5up.net" target="_blank">HTML5 UP</a>. Ported by <a href="//github.com/jpescador" target="_blank">Julio Pescador</a>. Powered by <a href="//gohugo.io" target="_blank">Hugo</a></p>
        </section>

</section>

            </div>
        <a id="back-to-top" href="#" class="fa fa-arrow-up fa-border fa-2x"></a>
        

        
        
            
        

        
        
            <script src="/js/jquery.min.js"></script>
            <script src="/js/skel.min.js"></script>
            <script src="/js/util.js"></script>
            <script src="/js/main.js"></script>
            <script src="/js/backToTop.js"></script>
            <script src="/js/highlight.pack.js"></script>
        

        

            
            <script>hljs.initHighlightingOnLoad();</script>
            
    </body>
</html>

