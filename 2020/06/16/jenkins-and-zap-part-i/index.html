<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Jenkins with ZAP - Part I &middot; Tony Towry</title>
        <meta name="description" content="ZAP Docker Weekly">
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="generator" content="Hugo 0.55.6" />
        <meta name="robots" content="index,follow">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta property="og:title" content="Jenkins with ZAP - Part I">
<meta property="og:description" content="ZAP Docker Weekly">
<meta property="og:type" content="article">
<meta property="og:url" content="/2020/06/16/jenkins-and-zap-part-i/">
        <link rel="stylesheet" href="/dist/styles.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,600,700,300&subset=latin,cyrillic-ext,latin-ext,cyrillic">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
        
    </head>
    <body>
        
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-46268936-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


        <div id="wrapper">
            <header class="site-header">
                <div class="container">
                    <div class="site-title-wrapper">
                        
                            <h1 class="site-title">
                                <a title="Cattleguard Blog" href="/">Cattleguard Blog</a>
                            </h1>
                        
                        <a class="button-square" href="/index.xml"><i class="fa fa-rss"></i></a>
                        
                            <a class="button-square button-social hint--top" data-hint="Twitter" title="Twitter" href="https://twitter.com/anthonytowry">
                                <i class="fa fa-twitter"></i>
                            </a>
                        
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Github" title="Github" href="https://github.com/cattleguard/">
                                <i class="fa fa-github-alt"></i>
                            </a>
                        
                        
                        
                            <a class="button-square button-social hint--top" data-hint="LinkedIn" title="LinkedIn" href="https://www.linkedin.com/in/tony-towry-99581515/">
                                <i class="fa fa-linkedin"></i>
                            </a>
                        
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Email" title="Email" href="mailto:anthonytowry@gmail.com">
                                <i class="fa fa-envelope"></i>
                            </a>
                        
                    </div>

                    <ul class="site-nav">
                        
    <li class="site-nav-item">
        <a title="Blog" href="/">Blog</a>
    </li>

    <li class="site-nav-item">
        <a title="About" href="/page/about/">About</a>
    </li>

    <li class="site-nav-item">
        <a title="Tony&#39;s Coffee Guide" href="/2017/06/25/coffee-guide/">Tony&#39;s Coffee Guide</a>
    </li>

                    </ul>
                </div>
            </header>

            <div id="container">


<div class="container">
    <article class="post-container" itemscope="" itemtype="http://schema.org/BlogPosting">
        <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Jenkins with ZAP - Part I</h1>
    
        <p class="post-description" itemprop="description">ZAP Docker Weekly</p>
    
    <p class="post-date">
        <span>Published <time datetime="2020-06-16" itemprop="datePublished">Tue, Jun 16, 2020</time></span>
        <span>by</span>
        <span itemscope="" itemprop="author" itemtype="https://schema.org/Person">
            <span itemprop="name">
                <a href="https://www.linkedin.com/in/tony-towry-99581515/" itemprop="url" rel="author"> Anthony Towry</a>
            </span>
        </span>
    </p>
</header>

        <div class="post-content clearfix" itemprop="articleBody">
    
        <img class="post-featured-image" src="/post/images/jenkins-pipeline-part1-heading.jpg">
    

    <p><div style="font-size:small;"> <em>Photo by <a href="https://unsplash.com/@steve_j">Steve Johnson</a> on Unsplash</em> </div><br/></p>

<p>So, I tried quite a few things that didn&rsquo;t work when integrating ZAP into Jenkins. Many of these were due to a general lack of knowledge with Jenkins. Some were due to holding on to personal objectives such as knowing that I was using the ZAP <code>owasp/zap2docker-weekly:latest</code> docker image.</p>

<p>I liked having each npm stage broken out for debugging purposes (though this seems to be not much of an issue right now since each step is broken out in Blue Ocean), but wasn&rsquo;t sure what to do to keep it all in one container and then pop-out to a new ZAP container in parallel at the end. I guess I was looking for a way to keep the pipeline agent the same until I wanted to override it in a parallel stage. I don&rsquo;t think this is practical at the moment. I did try to load it via sidecar, but this doesn&rsquo;t work in a declaritive pipeline?.?</p>

<p>So, this first draft works by holding the application open, giving ZAP enough time that <code>npm install</code> finishes, scanning the app and allowing the operator to finish the pipeline with the input message. I guess I could just leave them open for some length of time to avoid touch, but I plan on adding a few more tools and I&rsquo;m not quite sure how long they&rsquo;ll take to run yet.</p>

<p>So here&rsquo;s a parallel pipeline with ZAP integration:
<script src="https://gist.github.com/cattleguard/c6d686b173d84109e11cbbac27da1ddf.js"></script></p>

<p>Next I&rsquo;ll be looking at how to mark in-progress fixes on the ZAP report and passing an environment var for <code>export localip=<code>ip route get 1.1.1.1 | awk '{print $(NF-2);exit}'</code></code> so that it&rsquo;s not hardcoded in the pipeline.</p>

<p>Here it is in Blue Ocean with Zap failing due to <code>WARN-NEW:  6</code>
<img src="/post/images/zap-pipeline-part1.JPG" alt="Jenkins with ZAP part I" /></p>

<p>Anyway, definitely MVP territory, but I&rsquo;ll keep digging. Maybe I&rsquo;ll come back around to trying the plugin.</p>

</div>

        <footer class="post-footer clearfix">
    
        <p class="post-tags">
            <span>Tagged:</span>
            
            
                <a href="/tags/ci/cd/">ci/cd</a>, 
            
                <a href="/tags/devops/">devops</a>
            
        </p>
    

    <div class="share">
        
            <a class="icon-twitter" href="https://twitter.com/share?text=Jenkins%20with%20ZAP%20-%20Part%20I&url=%2f2020%2f06%2f16%2fjenkins-and-zap-part-i%2f"
                onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                <i class="fa fa-twitter"></i>
                <span class="hidden">Twitter</span>
            </a>
        

        
            <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=%2f2020%2f06%2f16%2fjenkins-and-zap-part-i%2f"
                onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                <i class="fa fa-facebook"></i>
                <span class="hidden">Facebook</span>
            </a>
        

        
        
    </div>
</footer>

        
    </article>
</div>

            </div>
        </div>

        <footer class="footer">
            <div class="container">
                <div class="site-title-wrapper">
                    <h1 class="site-title">
                        <a title="Cattleguard Blog" href="/">Cattleguard Blog</a>
                    </h1>
                    <a class="button-square button-jump-top js-jump-top" href="#">
                        <i class="fa fa-angle-up"></i>
                    </a>
                </div>

                <p class="footer-copyright">
                    <span>&copy; 2020 / Powered by <a href="https://gohugo.io/">Hugo</a></span>
                </p>
                <p class="footer-copyright">
                    <span><a href="https://github.com/roryg/ghostwriter">Ghostwriter theme</a> By <a href="http://jollygoodthemes.com">JollyGoodThemes</a></span>
                    <span>/ <a href="https://github.com/jbub/ghostwriter">Ported</a> to Hugo By <a href="https://github.com/jbub">jbub</a></span>
                </p>
            </div>
        </footer>

        <script src="/js/jquery-1.11.3.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>
        <script src="/js/jquery.fitvids.js"></script>
        <script src="/js/scripts.js"></script>
    </body>
</html>

